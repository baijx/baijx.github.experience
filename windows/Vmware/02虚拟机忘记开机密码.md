# 虚拟机忘记开机密码

### 1. 配置虚拟主机的CD-ROM
 启动VMware虚拟机程序 → 选中虚拟主机 → 编辑虚拟机设置 → CD-DVD → 连接 → 使用ISO映像文件 → 最后“确定”。

### 2. 进入安装Windows界面
启动虚拟主机 → 在进人系统前不停按ESC进入“boot menu”引导设置 → 选中CD-ROM Drive，敲回车 → 进入安装Windows界面。

### 3. 进Windows系统DOS命令窗口
在安装Windows界面“下一步” → “修复计算机(R)” → 默认第一项，点击“下一步”→ 点击“命令提示符”进入DOS窗口。

### 4. 替换系统登录界面"屏幕键盘"工具程序为CMD.EXE
```
a. 进入虚拟主机系统盘：C盘 
# C: 
# cd windows\system32
b. 替换登录系统界面的软键盘工具（osk.exe）为CMD.EXE
# rename osk.exe osk.bak      # 把osk.exe更名为osk.bak，将其备份
# copy cmd.exe osk.exe         # 把cmd.exe命名为osk.exe，将其替换
```

### 5. 勾选"软键盘"工具间接启动CMD.EXE
重新启动虚机，点击登录系统界面左下角的“轻松访问”按钮 → 勾选“屏幕键盘” → 点击确定弹出DOS窗口。

### 6. 在DOS窗口中设置管理员新的登录密码
```
# explorer     #修复命令，界面会出现各种个性化设置
# net user administrator Admin1234    #设置administrator用户的密码为Admin1234
# Exit            # 退出DOS窗口
此时就可以使用新密码登陆系统了
```

### 7. 恢复osk.bak为osk.exe
```
a. 使用新密码登录系统。
b. 进入'C:\Windows\System32'下先删除osk.exe，再改osk.bak为osk.exe。
注：不恢复也不影响系统使用。若直接修改失败，可在其它主机上复制一个osk.exe或重复上面步骤使用'rename osk.bak osk.exe'。
```